<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org" />
<title>基礎設定</title>
<meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79" />
<link rel="HOME" title="FreeBSD 使用手冊" href="index.html" />
<link rel="UP" title="列印" href="printing.html" />
<link rel="PREVIOUS" title="介紹" href="printing-intro-spooler.html" />
<link rel="NEXT" title="Advanced Printer Setup" href="printing-advanced.html" />
<link rel="STYLESHEET" type="text/css" href="docbook.css" />
<meta http-equiv="Content-Type" content="text/html; charset=Big5" />
</head>
<body class="SECT1" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084"
alink="#0000FF">
<div class="NAVHEADER">
<table summary="Header navigation table" width="100%" border="0" cellpadding="0"
cellspacing="0">
<tr>
<th colspan="3" align="center">FreeBSD 使用手冊</th>
</tr>

<tr>
<td width="10%" align="left" valign="bottom"><a href="printing-intro-spooler.html"
accesskey="P">Prev</a></td>
<td width="80%" align="center" valign="bottom">Chapter 9 列印</td>
<td width="10%" align="right" valign="bottom"><a href="printing-advanced.html"
accesskey="N">Next</a></td>
</tr>
</table>

<hr align="LEFT" width="100%" />
</div>

<div class="SECT1">
<h1 class="SECT1"><a id="PRINTING-INTRO-SETUP" name="PRINTING-INTRO-SETUP">9.3
基礎設定</a></h1>

<p>要用印表機搭配 <b class="APPLICATION">LPD</b> 多工緩衝系統，您需要有印表機這個硬體以及
<b class="APPLICATION">LPD</b> 這套軟體。 本手冊提供了兩階段的設定說明：</p>

<ul>
<li>
<p>閱讀 <a href="printing-intro-setup.html#PRINTING-SIMPLE">簡易印表機設定</a>
來學習如何連接印表機、讓印表機和 <b class="APPLICATION">LPD</b>
溝通以及列印純文字文件。</p>
</li>

<li>
<p>閱讀 <a href="printing-advanced.html">進階印表機設定</a>
來學習如何列印各種特殊格式文件、列印首頁、網路列印、
控制印表機權限以及統計使用狀況等。</p>
</li>
</ul>

<div class="SECT2">
<h2 class="SECT2"><a id="PRINTING-SIMPLE" name="PRINTING-SIMPLE">9.3.1
簡易印表機設定</a></h2>

<p>本章節會告訴您如何設定印表機設備和 <b class="APPLICATION">LPD</b> 軟體以使用印表機，
基本教學內容：</p>

<ul>
<li>
<p><a href="printing-intro-setup.html#PRINTING-HARDWARE">硬體設定</a>
會提示如何將印表機接上電腦的連接埠。</p>
</li>

<li>
<p><a href="printing-intro-setup.html#PRINTING-SOFTWARE">軟體設定</a> 會示範如何寫 <b
class="APPLICATION">LPD</b> 緩衝器設定檔 (<tt class="FILENAME">/etc/printcap</tt>)。</p>
</li>
</ul>

<p>如果您要把印表機設定接收網路列印資料而不是本機端的話，請參考 <a
href="printing-advanced.html#PRINTING-ADVANCED-NETWORK-NET-IF">印表機及網路資料傳輸介面</a>。</p>

<p>這個章節雖然叫做“簡易印表機設定”， 實際上還是有點複雜的。
最困難的部份是讓你的印表機和電腦上的 <b class="APPLICATION">LPD</b> 緩衝器能夠正常運作。
一旦印表機可以正常工作之後， 像是印首頁或是做列印統計這些進階的功能就不難做到了。</p>

<div class="SECT3">
<h3 class="SECT3"><a id="PRINTING-HARDWARE" name="PRINTING-HARDWARE">9.3.1.1
硬體設定</a></h3>

<p>本章節討論各種連接印表機到 PC 的方式。 這裡會提到不同種類的連接埠和連接線， 以及為了讓
FreeBSD 能和印表機溝通您可能會需要開啟的核心參數等。</p>

<p>如果您已經把印表機接上電腦， 而且在其他作業系統上有成功列印過的話，可以直接跳至 <a
href="printing-intro-setup.html#PRINTING-SOFTWARE">軟體設定</a>。</p>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-PORTS" name="PRINTING-PORTS">9.3.1.1.1
連接埠和排線</a></h4>

<p>市售個人電腦印表機一般來說不出這三種界面：</p>

<ul>
<li>
<p><span class="emphasis"><b class="EMPHASIS">序列 (Serial)</b></span> 界面，又稱為
RS-232 或 COM 埠， 用您電腦上的序列埠傳送資料到印表機。 序列界面廣泛的為電腦業界所採用，
所以排線容易取得，要設定連線並不困難。 然而序列介面有時候會需要使用較特別的排線，
這時候就有可能需要設定一些較為複雜的通訊參數了。 大部份 PC 序列埠的傳輸速度最高只到
115200&nbsp;bps， 因此想要用序列埠來列印大圖是不切實際的。</p>
</li>

<li>
<p><span class="emphasis"><b class="EMPHASIS">並列 (Parallel)</b></span>
界面利用電腦的並列埠將資料送到印表機。 並列埠比 RS-232
序列埠還快，也是一種電腦業界常用的界面。 這種界面的排線非常容易取得，但是較難用手工打造。
通常來說並列界面並沒有什麼通訊參數需要指定， 所以設定起來超級容易。</p>

<p>並列埠界面有時候也會被稱為 “Centronics” 界面，這是印表機的接頭的名稱。</p>
</li>

<li>
<p>USB 界面，也就是通用序列匯流排，傳輸速率比並列界面或是 RS-232 序列界面都來得快，而且
USB 排線單純又便宜。 對列印工作而言，USB 比 RS-232 序列埠或是並列埠都來得好，但是在 <span
class="TRADEMARK">UNIX</span>&reg; 系統上的支援度較差。 購買同時具有 USB
及並列埠兩種界面的印表機可以避免掉這種問題。</p>
</li>
</ul>

<p>一般而言，並列界面只能提供單向傳輸 (電腦至印表機)，而要用 USB 才能提供雙向。 然而在
FreeBSD 下，使用較新的並列埠 (EPP 和 ECP) 以及印表機，再配合使用 IEEE-1284
相容排線也可以做到雙向溝通。</p>

<p>電腦和印表機之間藉由並列埠行進雙向溝通的方式有兩種。
第一種是使用特製的、能和特定印表機溝通的 FreeBSD 印表機驅動程式。
這種方式在噴墨印表機上很常見，用來回報墨水存量以及其他狀態資訊等。 第二種方法是用 <span
class="TRADEMARK">PostScript</span>&reg;，如果印表機有支援的話。</p>

<p><span class="TRADEMARK">PostScript</span> 事實上是把程式碼送到印表機上去；
這些程式並不需要直接把東西印到紙上，而且可以把結果直接回傳給電腦。 <span
class="TRADEMARK">PostScript</span> 也用雙向通訊的方式來告知電腦有發生問題，像是 <span
class="TRADEMARK">PostScript</span>
程式有錯誤、或是卡紙之類，使用者們應該會需要這些資訊的。 更進一步來說，要在 <span
class="TRADEMARK">PostScript</span> 印表機上做列印統計也需要雙向通訊：
首先詢問印表機總列印頁數 (這台印表機出廠以來總共列印過的張數)，接著傳送使用者的工作，
然後再問一次總列印頁數。
把這兩個數值相減之後，就可以知道要向這位使用者收多少列印費用了。</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-PARALLEL" name="PRINTING-PARALLEL">9.3.1.1.2
並列埠</a></h4>

<p>要使用並列介面印表機時，需要把印表機和電腦用 Centronics 排線連接起來。
印表機或電腦附的使用說明書上應該會有詳細的操作指引。</p>

<p>還要記住您使用電腦的哪一個並列埠。 FreeBSD 上第一個並列埠叫做 <tt
class="FILENAME">ppc0</tt>，第二個則是 <tt class="FILENAME">ppc1</tt>，依此類推。
印表機的裝置名稱 (device name) 也用相同的規則，接在第一個並列埠的印表機就叫 <tt
class="FILENAME">/dev/lpt0</tt>，下略。</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-SERIAL" name="PRINTING-SERIAL">9.3.1.1.3
串列埠</a></h4>

<p>要使用串列介面印表機時， 需要找一條適用的串列排線把印表機和電腦連接起來。
印表機或電腦附的使用說明書上應該會有詳細的操作指引。</p>

<p>如果不確定哪條才是“適用的串列排線”， 以下有幾種可能的情況，您可以挑一種來試試：</p>

<ul>
<li>
<p>兩端的每根針腳直接對接的<span class="emphasis"><b class="EMPHASIS">數據機
(modem)</b></span> 排線。 這種排線又被稱為 “DTE-to-DCE” 排線。</p>
</li>

<li>
<p>有些腳直接對接，有些腳對調，有些腳短路的 <span class="emphasis"><b
class="EMPHASIS">null-modem</b></span> 排線。 這種排線又被稱為 “DTE-to-DTE” 排線。</p>
</li>

<li>
<p>某些較少見的印表機可能會需要 <span class="emphasis"><b class="EMPHASIS">serial
printer</b></span> 排線。 這種排線類似 null-modem 排線，但是有些短路的腳是通的。</p>
</li>
</ul>

<br />
<br />
<p>您應該還需要替印表機設定通訊參數，通常來說是用前面板或是 DIP 開關來設定。 把 <tt
class="LITERAL">bps</tt> (每秒多少位元，又稱為 <span class="emphasis"><b
class="EMPHASIS">baud rate</b></span>) 設成印表機和電腦所能支援的最大值，設定資料位元為 7
位元或 8 位元；沒有、奇數或偶數的同位元檢查；1 或 2 個停止位元。 還要選擇流量控制：
無、XON/XOFF (又稱為“頻內”或“軟體”流量控制)。
把設定值記下來接設設定軟體時會用到。</p>
</div>
</div>

<div class="SECT3">
<h3 class="SECT3"><a id="PRINTING-SOFTWARE" name="PRINTING-SOFTWARE">9.3.1.2
軟體設定</a></h3>

<p>本章節會提到在 FreeBSD 下用 <b class="APPLICATION">LPD</b>
列印緩衝系統印東西時所需要做的軟體設定。</p>

<p>大致上有這些步驟：</p>

<div class="PROCEDURE">
<ol type="1">
<li class="STEP">
<p>Configure your kernel, if necessary, for the port you are using for the printer;
section <a href="printing-intro-setup.html#PRINTING-KERNEL">Kernel Configuration</a>
tells you what you need to do.</p>
</li>

<li class="STEP">
<p>Set the communications mode for the parallel port, if you are using a parallel port;
section <a href="printing-intro-setup.html#PRINTING-PARALLEL-PORT-MODE">Setting the
Communication Mode for the Parallel Port</a> gives details.</p>
</li>

<li class="STEP">
<p>Test if the operating system can send data to the printer. Section <a
href="printing-intro-setup.html#PRINTING-TESTING">Checking Printer Communications</a>
gives some suggestions on how to do this.</p>
</li>

<li class="STEP">
<p>Set up <b class="APPLICATION">LPD</b> for the printer by modifying the file <tt
class="FILENAME">/etc/printcap</tt>. You will find out how to do this later in this
chapter.</p>
</li>
</ol>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-KERNEL" name="PRINTING-KERNEL">9.3.1.2.1 Kernel
Configuration</a></h4>

<p>The operating system kernel is compiled to work with a specific set of devices. The
serial or parallel interface for your printer is a part of that set. Therefore, it might
be necessary to add support for an additional serial or parallel port if your kernel is
not already configured for one.</p>

<p>To find out if the kernel you are currently using supports a serial interface,
type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">grep sio<tt
class="REPLACEABLE"><i>N</i></tt> /var/run/dmesg.boot</kbd>
</pre>

<p>Where <tt class="REPLACEABLE"><i>N</i></tt> is the number of the serial port, starting
from zero. If you see output similar to the following:</p>

<pre class="SCREEN">
sio2 at port 0x3e8-0x3ef irq 5 on isa
sio2: type 16550A
</pre>

<p>then the kernel supports the port.</p>

<p>To find out if the kernel supports a parallel interface, type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">grep ppc<tt
class="REPLACEABLE"><i>N</i></tt> /var/run/dmesg.boot</kbd>
</pre>

<p>Where <tt class="REPLACEABLE"><i>N</i></tt> is the number of the parallel port,
starting from zero. If you see output similar to the following:</p>

<pre class="SCREEN">
ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold
</pre>

<p>then the kernel supports the port.</p>

<p>You might have to reconfigure your kernel in order for the operating system to
recognize and use the parallel or serial port you are using for the printer.</p>

<p>To add support for a serial port, see the section on kernel configuration. To add
support for a parallel port, see that section <span class="emphasis"><b
class="EMPHASIS">and</b></span> the section that follows.</p>
</div>
</div>

<div class="SECT3">
<h3 class="SECT3"><a id="PRINTING-PARALLEL-PORT-MODE"
name="PRINTING-PARALLEL-PORT-MODE">9.3.1.3 Setting the Communication Mode for the
Parallel Port</a></h3>

<p>When you are using the parallel interface, you can choose whether FreeBSD should use
interrupt-driven or polled communication with the printer. The generic printer device
driver (<a href="http://www.FreeBSD.org/cgi/man.cgi?query=lpt&amp;sektion=4"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpt</span>(4)</span></a>) on FreeBSD
uses the <a href="http://www.FreeBSD.org/cgi/man.cgi?query=ppbus&amp;sektion=4"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">ppbus</span>(4)</span></a> system, which
controls the port chipset with the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">ppc</span>(4)</span></a> driver.</p>

<ul>
<li>
<p>The <span class="emphasis"><b class="EMPHASIS">interrupt-driven</b></span> method is
the default with the GENERIC kernel. With this method, the operating system uses an IRQ
line to determine when the printer is ready for data.</p>
</li>

<li>
<p>The <span class="emphasis"><b class="EMPHASIS">polled</b></span> method directs the
operating system to repeatedly ask the printer if it is ready for more data. When it
responds ready, the kernel sends more data.</p>
</li>
</ul>

<p>The interrupt-driven method is usually somewhat faster but uses up a precious IRQ
line. Some newer HP printers are claimed not to work correctly in interrupt mode,
apparently due to some (not yet exactly understood) timing problem. These printers need
polled mode. You should use whichever one works. Some printers will work in both modes,
but are painfully slow in interrupt mode.</p>

<p>You can set the communications mode in two ways: by configuring the kernel or by using
the <a href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptcontrol</span>(8)</span></a>
program.</p>

<p><span class="emphasis"><b class="EMPHASIS">To set the communications mode by
configuring the kernel:</b></span></p>

<div class="PROCEDURE">
<ol type="1">
<li class="STEP">
<p>Edit your kernel configuration file. Look for an <tt class="LITERAL">ppc0</tt> entry.
If you are setting up the second parallel port, use <tt class="LITERAL">ppc1</tt>
instead. Use <tt class="LITERAL">ppc2</tt> for the third port, and so on.</p>

<ul>
<li>
<p>If you want interrupt-driven mode, edit the following line:</p>

<pre class="PROGRAMLISTING">
hint.ppc.0.irq="<tt class="REPLACEABLE"><i>N</i></tt>"
</pre>

<p>in the <tt class="FILENAME">/boot/device.hints</tt> file and replace <tt
class="REPLACEABLE"><i>N</i></tt> with the right IRQ number. The kernel configuration
file must also contain the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ppc&amp;sektion=4"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">ppc</span>(4)</span></a> driver:</p>

<pre class="SCREEN">
device ppc
</pre>
</li>

<li>
<p>If you want polled mode, remove in your <tt class="FILENAME">/boot/device.hints</tt>
file, the following line:</p>

<pre class="PROGRAMLISTING">
hint.ppc.0.irq="<tt class="REPLACEABLE"><i>N</i></tt>"
</pre>

<p>In some cases, this is not enough to put the port in polled mode under FreeBSD. Most
of time it comes from <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">acpi</span>(4)</span></a> driver, this
latter is able to probe and attach devices, and therefore, control the access mode to the
printer port. You should check your <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=acpi&amp;sektion=4"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">acpi</span>(4)</span></a> configuration
to correct this problem.</p>
</li>
</ul>
</li>

<li class="STEP">
<p>Save the file. Then configure, build, and install the kernel, then reboot. See <a
href="kernelconfig.html">kernel configuration</a> for more details.</p>
</li>
</ol>
</div>

<p><span class="emphasis"><b class="EMPHASIS">To set the communications mode
with</b></span> <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptcontrol</span>(8)</span></a>:</p>

<div class="PROCEDURE">
<ol type="1">
<li class="STEP">
<p>Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">lptcontrol -i -d /dev/lpt<tt
class="REPLACEABLE"><i>N</i></tt></kbd>
</pre>

<p>to set interrupt-driven mode for <tt class="LITERAL">lpt<tt
class="REPLACEABLE"><i>N</i></tt></tt>.</p>
</li>

<li class="STEP">
<p>Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">lptcontrol -p -d /dev/lpt<tt
class="REPLACEABLE"><i>N</i></tt></kbd>
</pre>

<p>to set polled-mode for <tt class="LITERAL">lpt<tt
class="REPLACEABLE"><i>N</i></tt></tt>.</p>
</li>
</ol>
</div>

<p>You could put these commands in your <tt class="FILENAME">/etc/rc.local</tt> file to
set the mode each time your system boots. See <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptcontrol</span>(8)</span></a> for more
information.</p>
</div>

<div class="SECT3">
<h3 class="SECT3"><a id="PRINTING-TESTING" name="PRINTING-TESTING">9.3.1.4 Checking
Printer Communications</a></h3>

<p>Before proceeding to configure the spooling system, you should make sure the operating
system can successfully send data to your printer. It is a lot easier to debug printer
communication and the spooling system separately.</p>

<p>To test the printer, we will send some text to it. For printers that can immediately
print characters sent to them, the program <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a> is perfect:
it generates all 96 printable ASCII characters in 96 lines.</p>

<p>For a <span class="TRADEMARK">PostScript</span> (or other language-based) printer, we
will need a more sophisticated test. A small <span class="TRADEMARK">PostScript</span>
program, such as the following, will suffice:</p>

<pre class="PROGRAMLISTING">
%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Is this thing working?) show
showpage
</pre>

<p>The above <span class="TRADEMARK">PostScript</span> code can be placed into a file and
used as shown in the examples appearing in the following sections.</p>

<div class="NOTE">
<blockquote class="NOTE">
<p><b>Note:</b> When this document refers to a printer language, it is assuming a
language like <span class="TRADEMARK">PostScript</span>, and not Hewlett Packard's PCL.
Although PCL has great functionality, you can intermingle plain text with its escape
sequences. <span class="TRADEMARK">PostScript</span> cannot directly print plain text,
and that is the kind of printer language for which we must make special
accommodations.</p>
</blockquote>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-CHECKING-PARALLEL"
name="PRINTING-CHECKING-PARALLEL">9.3.1.4.1 Checking a Parallel Printer</a></h4>

<p>This section tells you how to check if FreeBSD can communicate with a printer
connected to a parallel port.</p>

<p><span class="emphasis"><b class="EMPHASIS">To test a printer on a parallel
port:</b></span></p>

<div class="PROCEDURE">
<ol type="1">
<li class="STEP">
<p>Become <tt class="USERNAME">root</tt> with <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">su</span>(1)</span></a>.</p>
</li>

<li class="STEP">
<p>Send data to the printer.</p>

<ul>
<li>
<p>If the printer can print plain text, then use <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a>. Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">lptest &gt; /dev/lpt<tt
class="REPLACEABLE"><i>N</i></tt></kbd>
</pre>

<p>Where <tt class="REPLACEABLE"><i>N</i></tt> is the number of the parallel port,
starting from zero.</p>
</li>

<li>
<p>If the printer understands <span class="TRADEMARK">PostScript</span> or other printer
language, then send a small program to the printer. Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">cat &gt; /dev/lpt<tt
class="REPLACEABLE"><i>N</i></tt></kbd>
</pre>

<p>Then, line by line, type the program <span class="emphasis"><b
class="EMPHASIS">carefully</b></span> as you cannot edit a line once you have pressed <tt
class="LITERAL">RETURN</tt> or <tt class="LITERAL">ENTER</tt>. When you have finished
entering the program, press <tt class="LITERAL">CONTROL+D</tt>, or whatever your end of
file key is.</p>

<p>Alternatively, you can put the program in a file and type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">cat <tt
class="REPLACEABLE"><i>file</i></tt> &gt; /dev/lpt<tt
class="REPLACEABLE"><i>N</i></tt></kbd>
</pre>

<p>Where <tt class="REPLACEABLE"><i>file</i></tt> is the name of the file containing the
program you want to send to the printer.</p>
</li>
</ul>
</li>
</ol>
</div>

<p>You should see something print. Do not worry if the text does not look right; we will
fix such things later.</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-CHECKING-SERIAL"
name="PRINTING-CHECKING-SERIAL">9.3.1.4.2 Checking a Serial Printer</a></h4>

<p>This section tells you how to check if FreeBSD can communicate with a printer on a
serial port.</p>

<p><span class="emphasis"><b class="EMPHASIS">To test a printer on a serial
port:</b></span></p>

<div class="PROCEDURE">
<ol type="1">
<li class="STEP">
<p>Become <tt class="USERNAME">root</tt> with <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=su&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">su</span>(1)</span></a>.</p>
</li>

<li class="STEP">
<p>Edit the file <tt class="FILENAME">/etc/remote</tt>. Add the following entry:</p>

<pre class="PROGRAMLISTING">
printer:dv=/dev/<tt class="REPLACEABLE"><i>port</i></tt>:br#<tt
class="REPLACEABLE"><i>bps-rate</i></tt>:pa=<tt class="REPLACEABLE"><i>parity</i></tt>
</pre>

<p>Where <tt class="REPLACEABLE"><i>port</i></tt> is the device entry for the serial port
(<tt class="LITERAL">ttyd0</tt>, <tt class="LITERAL">ttyd1</tt>, etc.), <tt
class="REPLACEABLE"><i>bps-rate</i></tt> is the bits-per-second rate at which the printer
communicates, and <tt class="REPLACEABLE"><i>parity</i></tt> is the parity required by
the printer (either <tt class="LITERAL">even</tt>, <tt class="LITERAL">odd</tt>, <tt
class="LITERAL">none</tt>, or <tt class="LITERAL">zero</tt>).</p>

<p>Here is a sample entry for a printer connected via a serial line to the third serial
port at 19200&nbsp;bps with no parity:</p>

<pre class="PROGRAMLISTING">
printer:dv=/dev/ttyd2:br#19200:pa=none
</pre>
</li>

<li class="STEP">
<p>Connect to the printer with <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">tip</span>(1)</span></a>. Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">tip printer</kbd>
</pre>

<p>If this step does not work, edit the file <tt class="FILENAME">/etc/remote</tt> again
and try using <tt class="FILENAME">/dev/cuaa<tt class="REPLACEABLE"><i>N</i></tt></tt>
instead of <tt class="FILENAME">/dev/ttyd<tt class="REPLACEABLE"><i>N</i></tt></tt>.</p>
</li>

<li class="STEP">
<p>Send data to the printer.</p>

<ul>
<li>
<p>If the printer can print plain text, then use <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a>. Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">%</samp> <kbd class="USERINPUT">$lptest</kbd>
</pre>
</li>

<li>
<p>If the printer understands <span class="TRADEMARK">PostScript</span> or other printer
language, then send a small program to the printer. Type the program, line by line, <span
class="emphasis"><b class="EMPHASIS">very carefully</b></span> as backspacing or other
editing keys may be significant to the printer. You may also need to type a special
end-of-file key for the printer so it knows it received the whole program. For <span
class="TRADEMARK">PostScript</span> printers, press <tt
class="LITERAL">CONTROL+D</tt>.</p>

<p>Alternatively, you can put the program in a file and type:</p>

<pre class="SCREEN">
<samp class="PROMPT">%</samp> <kbd class="USERINPUT">&gt;<tt
class="REPLACEABLE"><i>file</i></tt></kbd>
</pre>

<p>Where <tt class="REPLACEABLE"><i>file</i></tt> is the name of the file containing the
program. After <a href="http://www.FreeBSD.org/cgi/man.cgi?query=tip&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">tip</span>(1)</span></a> sends the file,
press any required end-of-file key.</p>
</li>
</ul>
</li>
</ol>
</div>

<p>You should see something print. Do not worry if the text does not look right; we will
fix that later.</p>
</div>
</div>

<div class="SECT3">
<h3 class="SECT3"><a id="PRINTING-PRINTCAP" name="PRINTING-PRINTCAP">9.3.1.5 Enabling the
Spooler: the <tt class="FILENAME">/etc/printcap</tt> File</a></h3>

<p>At this point, your printer should be hooked up, your kernel configured to communicate
with it (if necessary), and you have been able to send some simple data to the printer.
Now, we are ready to configure <b class="APPLICATION">LPD</b> to control access to your
printer.</p>

<p>You configure <b class="APPLICATION">LPD</b> by editing the file <tt
class="FILENAME">/etc/printcap</tt>. The <b class="APPLICATION">LPD</b> spooling system
reads this file each time the spooler is used, so updates to the file take immediate
effect.</p>

<p>The format of the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=printcap&amp;sektion=5"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">printcap</span>(5)</span></a> file is
straightforward. Use your favorite text editor to make changes to <tt
class="FILENAME">/etc/printcap</tt>. The format is identical to other capability files
like <tt class="FILENAME">/usr/share/misc/termcap</tt> and <tt
class="FILENAME">/etc/remote</tt>. For complete information about the format, see the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cgetent&amp;sektion=3"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">cgetent</span>(3)</span></a>.</p>

<p>The simple spooler configuration consists of the following steps:</p>

<div class="PROCEDURE">
<ol type="1">
<li class="STEP">
<p>Pick a name (and a few convenient aliases) for the printer, and put them in the <tt
class="FILENAME">/etc/printcap</tt> file; see the <a
href="printing-intro-setup.html#PRINTING-NAMING">Naming the Printer</a> section for more
information on naming.</p>
</li>

<li class="STEP">
<p>Turn off header pages (which are on by default) by inserting the <tt
class="LITERAL">sh</tt> capability; see the <a
href="printing-intro-setup.html#PRINTING-NO-HEADER-PAGES">Suppressing Header Pages</a>
section for more information.</p>
</li>

<li class="STEP">
<p>Make a spooling directory, and specify its location with the <tt
class="LITERAL">sd</tt> capability; see the <a
href="printing-intro-setup.html#PRINTING-SPOOLDIR">Making the Spooling Directory</a>
section for more information.</p>
</li>

<li class="STEP">
<p>Set the <tt class="FILENAME">/dev</tt> entry to use for the printer, and note it in
<tt class="FILENAME">/etc/printcap</tt> with the <tt class="LITERAL">lp</tt> capability;
see the <a href="printing-intro-setup.html#PRINTING-DEVICE">Identifying the Printer
Device</a> for more information. Also, if the printer is on a serial port, set up the
communication parameters with the <tt class="LITERAL">ms#</tt> capability which is
discussed in the <a href="printing-intro-setup.html#PRINTING-COMMPARAM">Configuring
Spooler Communications Parameters</a> section.</p>
</li>

<li class="STEP">
<p>Install a plain text input filter; see the <a
href="printing-intro-setup.html#PRINTING-TEXTFILTER">Installing the Text Filter</a>
section for details.</p>
</li>

<li class="STEP">
<p>Test the setup by printing something with the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpr</span>(1)</span></a> command. More
details are available in the <a href="printing-intro-setup.html#PRINTING-TRYING">Trying
It Out</a> and <a href="printing-troubleshooting.html">Troubleshooting</a> sections.</p>
</li>
</ol>
</div>

<div class="NOTE">
<blockquote class="NOTE">
<p><b>Note:</b> Language-based printers, such as <span
class="TRADEMARK">PostScript</span> printers, cannot directly print plain text. The
simple setup outlined above and described in the following sections assumes that if you
are installing such a printer you will print only files that the printer can
understand.</p>
</blockquote>
</div>

<p>Users often expect that they can print plain text to any of the printers installed on
your system. Programs that interface to <b class="APPLICATION">LPD</b> to do their
printing usually make the same assumption. If you are installing such a printer and want
to be able to print jobs in the printer language <span class="emphasis"><b
class="EMPHASIS">and</b></span> print plain text jobs, you are strongly urged to add an
additional step to the simple setup outlined above: install an automatic
plain-text-to-<span class="TRADEMARK">PostScript</span> (or other printer language)
conversion program. The section entitled <a
href="printing-advanced.html#PRINTING-ADVANCED-IF-CONVERSION">Accommodating Plain Text
Jobs on <span class="TRADEMARK">PostScript</span> Printers</a> tells how to do this.</p>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-NAMING" name="PRINTING-NAMING">9.3.1.5.1 Naming the
Printer</a></h4>

<p>The first (easy) step is to pick a name for your printer. It really does not matter
whether you choose functional or whimsical names since you can also provide a number of
aliases for the printer.</p>

<p>At least one of the printers specified in the <tt class="FILENAME">/etc/printcap</tt>
should have the alias <tt class="LITERAL">lp</tt>. This is the default printer's name. If
users do not have the <tt class="ENVAR">PRINTER</tt> environment variable nor specify a
printer name on the command line of any of the <b class="APPLICATION">LPD</b> commands,
then <tt class="LITERAL">lp</tt> will be the default printer they get to use.</p>

<p>Also, it is common practice to make the last alias for a printer be a full description
of the printer, including make and model.</p>

<p>Once you have picked a name and some common aliases, put them in the <tt
class="FILENAME">/etc/printcap</tt> file. The name of the printer should start in the
leftmost column. Separate each alias with a vertical bar and put a colon after the last
alias.</p>

<p>In the following example, we start with a skeletal <tt
class="FILENAME">/etc/printcap</tt> that defines two printers (a Diablo 630 line printer
and a Panasonic KX-P4455 <span class="TRADEMARK">PostScript</span> laser printer):</p>

<pre class="PROGRAMLISTING">
#
#  /etc/printcap for host rose
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:
</pre>

<p>In this example, the first printer is named <tt class="LITERAL">rattan</tt> and has as
aliases <tt class="LITERAL">line</tt>, <tt class="LITERAL">diablo</tt>, <tt
class="LITERAL">lp</tt>, and <tt class="LITERAL">Diablo 630 Line Printer</tt>. Since it
has the alias <tt class="LITERAL">lp</tt>, it is also the default printer. The second is
named <tt class="LITERAL">bamboo</tt>, and has as aliases <tt class="LITERAL">ps</tt>,
<tt class="LITERAL">PS</tt>, <tt class="LITERAL">S</tt>, <tt
class="LITERAL">panasonic</tt>, and <tt class="LITERAL">Panasonic KX-P4455 PostScript
v51.4</tt>.</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-NO-HEADER-PAGES"
name="PRINTING-NO-HEADER-PAGES">9.3.1.5.2 Suppressing Header Pages</a></h4>

<p>The <b class="APPLICATION">LPD</b> spooling system will by default print a <span
class="emphasis"><b class="EMPHASIS">header page</b></span> for each job. The header page
contains the user name who requested the job, the host from which the job came, and the
name of the job, in nice large letters. Unfortunately, all this extra text gets in the
way of debugging the simple printer setup, so we will suppress header pages.</p>

<p>To suppress header pages, add the <tt class="LITERAL">sh</tt> capability to the entry
for the printer in <tt class="FILENAME">/etc/printcap</tt>. Here is an example <tt
class="FILENAME">/etc/printcap</tt> with <tt class="LITERAL">sh</tt> added:</p>

<pre class="PROGRAMLISTING">
#
#  /etc/printcap for host rose - no header pages anywhere
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:
</pre>

<p>Note how we used the correct format: the first line starts in the leftmost column, and
subsequent lines are indented. Every line in an entry except the last ends in a backslash
character.</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-SPOOLDIR" name="PRINTING-SPOOLDIR">9.3.1.5.3 Making the
Spooling Directory</a></h4>

<p>The next step in the simple spooler setup is to make a <span class="emphasis"><b
class="EMPHASIS">spooling directory</b></span>, a directory where print jobs reside until
they are printed, and where a number of other spooler support files live.</p>

<p>Because of the variable nature of spooling directories, it is customary to put these
directories under <tt class="FILENAME">/var/spool</tt>. It is not necessary to backup the
contents of spooling directories, either. Recreating them is as simple as running <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=mkdir&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">mkdir</span>(1)</span></a>.</p>

<p>It is also customary to make the directory with a name that is identical to the name
of the printer, as shown below:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">mkdir /var/spool/<tt
class="REPLACEABLE"><i>printer-name</i></tt></kbd>
</pre>

<p>However, if you have a lot of printers on your network, you might want to put the
spooling directories under a single directory that you reserve just for printing with <b
class="APPLICATION">LPD</b>. We will do this for our two example printers <tt
class="LITERAL">rattan</tt> and <tt class="LITERAL">bamboo</tt>:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">mkdir /var/spool/lpd</kbd>
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">mkdir /var/spool/lpd/rattan</kbd>
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">mkdir /var/spool/lpd/bamboo</kbd>
</pre>

<div class="NOTE">
<blockquote class="NOTE">
<p><b>Note:</b> If you are concerned about the privacy of jobs that users print, you
might want to protect the spooling directory so it is not publicly accessible. Spooling
directories should be owned and be readable, writable, and searchable by user daemon and
group daemon, and no one else. We will do this for our example printers:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd
class="USERINPUT">chown daemon:daemon /var/spool/lpd/rattan</kbd>
<samp class="PROMPT">#</samp> <kbd
class="USERINPUT">chown daemon:daemon /var/spool/lpd/bamboo</kbd>
<samp class="PROMPT">#</samp> <kbd
class="USERINPUT">chmod 770 /var/spool/lpd/rattan</kbd>
<samp class="PROMPT">#</samp> <kbd
class="USERINPUT">chmod 770 /var/spool/lpd/bamboo</kbd>
</pre>
</blockquote>
</div>

<p>Finally, you need to tell <b class="APPLICATION">LPD</b> about these directories using
the <tt class="FILENAME">/etc/printcap</tt> file. You specify the pathname of the
spooling directory with the <tt class="LITERAL">sd</tt> capability:</p>

<pre class="PROGRAMLISTING">
#
#  /etc/printcap for host rose - added spooling directories
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:
</pre>

<p>Note that the name of the printer starts in the first column but all other entries
describing the printer should be indented and each line end escaped with a backslash.</p>

<p>If you do not specify a spooling directory with <tt class="LITERAL">sd</tt>, the
spooling system will use <tt class="FILENAME">/var/spool/lpd</tt> as a default.</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-DEVICE" name="PRINTING-DEVICE">9.3.1.5.4 Identifying
the Printer Device</a></h4>

<p>In the Entries for the Ports section, we identified which entry in the <tt
class="FILENAME">/dev</tt> directory FreeBSD will use to communicate with the printer.
Now, we tell <b class="APPLICATION">LPD</b> that information. When the spooling system
has a job to print, it will open the specified device on behalf of the filter program
(which is responsible for passing data to the printer).</p>

<p>List the <tt class="FILENAME">/dev</tt> entry pathname in the <tt
class="FILENAME">/etc/printcap</tt> file using the <tt class="LITERAL">lp</tt>
capability.</p>

<p>In our running example, let us assume that <tt class="LITERAL">rattan</tt> is on the
first parallel port, and <tt class="LITERAL">bamboo</tt> is on a sixth serial port; here
are the additions to <tt class="FILENAME">/etc/printcap</tt>:</p>

<pre class="PROGRAMLISTING">
#
#  /etc/printcap for host rose - identified what devices to use
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:
</pre>

<p>If you do not specify the <tt class="LITERAL">lp</tt> capability for a printer in your
<tt class="FILENAME">/etc/printcap</tt> file, <b class="APPLICATION">LPD</b> uses <tt
class="FILENAME">/dev/lp</tt> as a default. <tt class="FILENAME">/dev/lp</tt> currently
does not exist in FreeBSD.</p>

<p>If the printer you are installing is connected to a parallel port, skip to the section
entitled, <a href="printing-intro-setup.html#PRINTING-TEXTFILTER">Installing the Text
Filter</a>. Otherwise, be sure to follow the instructions in the next section.</p>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-COMMPARAM" name="PRINTING-COMMPARAM">9.3.1.5.5
Configuring Spooler Communication Parameters</a></h4>

<p>For printers on serial ports, <b class="APPLICATION">LPD</b> can set up the bps rate,
parity, and other serial communication parameters on behalf of the filter program that
sends data to the printer. This is advantageous since:</p>

<ul>
<li>
<p>It lets you try different communication parameters by simply editing the <tt
class="FILENAME">/etc/printcap</tt> file; you do not have to recompile the filter
program.</p>
</li>

<li>
<p>It enables the spooling system to use the same filter program for multiple printers
which may have different serial communication settings.</p>
</li>
</ul>

<p>The following <tt class="FILENAME">/etc/printcap</tt> capabilities control serial
communication parameters of the device listed in the <tt class="LITERAL">lp</tt>
capability:</p>

<div class="VARIABLELIST">
<dl>
<dt><tt class="LITERAL">br#<tt class="REPLACEABLE"><i>bps-rate</i></tt></tt></dt>

<dd>
<p>Sets the communications speed of the device to <tt
class="REPLACEABLE"><i>bps-rate</i></tt>, where <tt
class="REPLACEABLE"><i>bps-rate</i></tt> can be 50, 75, 110, 134, 150, 200, 300, 600,
1200, 1800, 2400, 4800, 9600, 19200, 38400, 57600, or 115200 bits-per-second.</p>
</dd>

<dt><tt class="LITERAL">ms#<tt class="REPLACEABLE"><i>stty-mode</i></tt></tt></dt>

<dd>
<p>Sets the options for the terminal device after opening the device. <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">stty</span>(1)</span></a> explains the
available options.</p>
</dd>
</dl>
</div>

<p>When <b class="APPLICATION">LPD</b> opens the device specified by the <tt
class="LITERAL">lp</tt> capability, it sets the characteristics of the device to those
specified with the <tt class="LITERAL">ms#</tt> capability. Of particular interest will
be the <tt class="LITERAL">parenb</tt>, <tt class="LITERAL">parodd</tt>, <tt
class="LITERAL">cs5</tt>, <tt class="LITERAL">cs6</tt>, <tt class="LITERAL">cs7</tt>, <tt
class="LITERAL">cs8</tt>, <tt class="LITERAL">cstopb</tt>, <tt
class="LITERAL">crtscts</tt>, and <tt class="LITERAL">ixon</tt> modes, which are
explained in the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=stty&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">stty</span>(1)</span></a> manual
page.</p>

<p>Let us add to our example printer on the sixth serial port. We will set the bps rate
to 38400. For the mode, we will set no parity with <tt class="LITERAL">-parenb</tt>,
8-bit characters with <tt class="LITERAL">cs8</tt>, no modem control with <tt
class="LITERAL">clocal</tt> and hardware flow control with <tt
class="LITERAL">crtscts</tt>:</p>

<pre class="PROGRAMLISTING">
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:
</pre>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-TEXTFILTER" name="PRINTING-TEXTFILTER">9.3.1.5.6
Installing the Text Filter</a></h4>

<p>We are now ready to tell <b class="APPLICATION">LPD</b> what text filter to use to
send jobs to the printer. A <span class="emphasis"><b class="EMPHASIS">text
filter</b></span>, also known as an <span class="emphasis"><b class="EMPHASIS">input
filter</b></span>, is a program that <b class="APPLICATION">LPD</b> runs when it has a
job to print. When <b class="APPLICATION">LPD</b> runs the text filter for a printer, it
sets the filter's standard input to the job to print, and its standard output to the
printer device specified with the <tt class="LITERAL">lp</tt> capability. The filter is
expected to read the job from standard input, perform any necessary translation for the
printer, and write the results to standard output, which will get printed. For more
information on the text filter, see the <a
href="printing-advanced.html#PRINTING-ADVANCED-FILTERS">Filters</a> section.</p>

<p>For our simple printer setup, the text filter can be a small shell script that just
executes <tt class="COMMAND">/bin/cat</tt> to send the job to the printer. FreeBSD comes
with another filter called <tt class="FILENAME">lpf</tt> that handles backspacing and
underlining for printers that might not deal with such character streams well. And, of
course, you can use any other filter program you want. The filter <tt
class="COMMAND">lpf</tt> is described in detail in section entitled <a
href="printing-advanced.html#PRINTING-ADVANCED-LPF">lpf: a Text Filter</a>.</p>

<p>First, let us make the shell script <tt
class="FILENAME">/usr/local/libexec/if-simple</tt> be a simple text filter. Put the
following text into that file with your favorite text editor:</p>

<pre class="PROGRAMLISTING">
#!/bin/sh
#
# if-simple - Simple text input filter for lpd
# Installed in /usr/local/libexec/if-simple
#
# Simply copies stdin to stdout.  Ignores all filter arguments.

/bin/cat &amp;&amp; exit 0
exit 2
</pre>

<p>Make the file executable:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd
class="USERINPUT">chmod 555 /usr/local/libexec/if-simple</kbd>
</pre>

<p>And then tell LPD to use it by specifying it with the <tt class="LITERAL">if</tt>
capability in <tt class="FILENAME">/etc/printcap</tt>. We will add it to the two printers
we have so far in the example <tt class="FILENAME">/etc/printcap</tt>:</p>

<pre class="PROGRAMLISTING">
#
#  /etc/printcap for host rose - added text filter
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\ :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:\
        :if=/usr/local/libexec/if-simple:
</pre>

<div class="NOTE">
<blockquote class="NOTE">
<p><b>Note:</b> A copy of the <tt class="FILENAME">if-simple</tt> script can be found in
the <tt class="FILENAME">/usr/share/examples/printing</tt> directory.</p>
</blockquote>
</div>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="AEN10494" name="AEN10494">9.3.1.5.7 Turn on <b
class="APPLICATION">LPD</b></a></h4>

<p><a href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpd</span>(8)</span></a> is run from <tt
class="FILENAME">/etc/rc</tt>, controlled by the <tt class="LITERAL">lpd_enable</tt>
variable. This variable defaults to <tt class="LITERAL">NO</tt>. If you have not done so
already, add the line:</p>

<pre class="PROGRAMLISTING">
lpd_enable="YES"
</pre>

<p>to <tt class="FILENAME">/etc/rc.conf</tt>, and then either restart your machine, or
just run <a href="http://www.FreeBSD.org/cgi/man.cgi?query=lpd&amp;sektion=8"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpd</span>(8)</span></a>.</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">lpd</kbd>
</pre>
</div>

<div class="SECT4">
<h4 class="SECT4"><a id="PRINTING-TRYING" name="PRINTING-TRYING">9.3.1.5.8 Trying It
Out</a></h4>

<p>You have reached the end of the simple <b class="APPLICATION">LPD</b> setup.
Unfortunately, congratulations are not quite yet in order, since we still have to test
the setup and correct any problems. To test the setup, try printing something. To print
with the <b class="APPLICATION">LPD</b> system, you use the command <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpr</span>(1)</span></a>, which submits
a job for printing.</p>

<p>You can combine <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpr</span>(1)</span></a> with the <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a> program,
introduced in section <a href="printing-intro-setup.html#PRINTING-TESTING">Checking
Printer Communications</a> to generate some test text.</p>

<p><span class="emphasis"><b class="EMPHASIS">To test the simple LPD
setup:</b></span></p>

<p>Type:</p>

<pre class="SCREEN">
<samp class="PROMPT">#</samp> <kbd class="USERINPUT">lptest 20 5 | lpr -P<tt
class="REPLACEABLE"><i>printer-name</i></tt></kbd>
</pre>

<p>Where <tt class="REPLACEABLE"><i>printer-name</i></tt> is a the name of a printer (or
an alias) specified in <tt class="FILENAME">/etc/printcap</tt>. To test the default
printer, type <a href="http://www.FreeBSD.org/cgi/man.cgi?query=lpr&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lpr</span>(1)</span></a> without any
<code class="OPTION">-P</code> argument. Again, if you are testing a printer that expects
<span class="TRADEMARK">PostScript</span>, send a <span
class="TRADEMARK">PostScript</span> program in that language instead of using <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a>. You can do
so by putting the program in a file and typing <tt class="COMMAND">lpr <tt
class="REPLACEABLE"><i>file</i></tt></tt>.</p>

<p>For a <span class="TRADEMARK">PostScript</span> printer, you should get the results of
the program. If you are using <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a>, then your
results should look like the following:</p>

<pre class="PROGRAMLISTING">
!"#$%&amp;'()*+,-./01234
"#$%&amp;'()*+,-./012345
#$%&amp;'()*+,-./0123456
$%&amp;'()*+,-./01234567
%&amp;'()*+,-./012345678
</pre>

<p>To further test the printer, try downloading larger programs (for language-based
printers) or running <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lptest&amp;sektion=1"><span
class="CITEREFENTRY"><span class="REFENTRYTITLE">lptest</span>(1)</span></a> with
different arguments. For example, <tt class="COMMAND">lptest 80 60</tt> will produce 60
lines of 80 characters each.</p>

<p>If the printer did not work, see the <a
href="printing-troubleshooting.html">Troubleshooting</a> section.</p>
</div>
</div>
</div>
</div>

<div class="NAVFOOTER">
<hr align="LEFT" width="100%" />
<table summary="Footer navigation table" width="100%" border="0" cellpadding="0"
cellspacing="0">
<tr>
<td width="33%" align="left" valign="top"><a href="printing-intro-spooler.html"
accesskey="P">Prev</a></td>
<td width="34%" align="center" valign="top"><a href="index.html"
accesskey="H">Home</a></td>
<td width="33%" align="right" valign="top"><a href="printing-advanced.html"
accesskey="N">Next</a></td>
</tr>

<tr>
<td width="33%" align="left" valign="top">介紹</td>
<td width="34%" align="center" valign="top"><a href="printing.html"
accesskey="U">Up</a></td>
<td width="33%" align="right" valign="top">Advanced Printer Setup</td>
</tr>
</table>
</div>

<p align="center"><small>本文及其他文件，可由此下載：<a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>。</small></p>

<p align="center"><small>若有 FreeBSD 方面疑問，請先閱讀 <a
href="http://www.FreeBSD.org/docs.html">FreeBSD 相關文件</a>，如不能解決的話，再洽詢
&#60;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&#62;。<br />
關於本文件的問題，請洽詢 &#60;<a
href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&#62;。</small></p>
</body>
</html>

